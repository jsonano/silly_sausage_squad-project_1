<!DOCTYPE html>
<!--
  # sIlLySaUsAgEsQuAD P1M_Jason_Chao, DALEX luo, Devo Leon Huang, DeV0(O0) Stanley HOO(HO0O)
  # SoftDev
  # P01: ArRESTed Development
  # Due 2024-12-17
  # time spent:
 -->

<html>
  <head>
    <title> API RESULTS </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>

  <body>
    <header>
        <!-- Allows flashing messages in the html -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
              {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
        <!-- Displays the welcome container if user is logged in -->
        {% if session['username'] %}
            <div class="welcome-container">
                Welcome, {{ session['username'] }}
                <a href="{{ url_for('logout') }}" class="signout-btn">Sign Out</a>
            </div>
        {% else %}
            <!-- The existing login container if user is not logged in -->
            <div class="login-container">
                <form class="login-form" action="/login" method="POST">
                    <input type="text" name="username" placeholder="Username" required>
                    <input type="password" name="password" placeholder="Password" required>
                    <div class="button-container">
                        <button type="submit" class="login-btn">Login</button>
                        <a href="{{ url_for('register') }}" class="signup-btn-link"><button type="button" class="signup-btn">Sign Up</button></a>
                    </div>
                </form>
            </div>
        {% endif %}
    </header>
    <nav>
      <ul>
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('logout') }}">Logout</a>
      </ul>
    </nav>
    <main>
      <h2>Submit an Image or Search for Results</h2>
      <form method="POST" action="{{ url_for('process_api') }}" enctype="multipart/form-data">
        <label for="image_input">Upload an Image:</label>
        <input type="file" name="image" id="image_input" accept="image/*">
        <label for="image_url">Or Image URL:</label>
        <input type="url" name="image_url" id="image_url" placeholder="https://example.com/image.jpg">
        <label for="search_query">Or Search Keywords:</label>
        <input type="text" name="search_query" id="search_query" placeholder="e.g., sunset, mountains">
        <button type="submit">Analyze</button>
      </form>

      {% if results %}
      <h2>Analysis Results</h2>
      <div>
        <img src="{{ results['image_url'] }}" alt="Analyzed Image" style="max-width: 300px;">
        <p><strong>Description:</strong> {{ results['description'] }}</p>
        <h3>Videos:</h3>
        <ul>
          {% for video in results['videos'] %}
          <li><a href="{{ video }}" target="_blank">View Video</a></li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </main>


  <footer>
    sIlLySaUsAgEsQuAD 2024
  </footer>


  </body>



</html>
